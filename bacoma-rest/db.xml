<?xml version="1.0" encoding="UTF-8"?>

<site version="2" url="pmcms.demo.site">
  <title><![CDATA[A very simple demo site!]]></title>
  <transfer host="127.0.0.1" user="poormans" startdir="htdocs"/>
  <macro>
    <name><![CDATA[user_menu.vm]]></name>
    <text><![CDATA[#macro(mainmenu)
<ul>#if( $!sitetool.WelcomePage )
  #set( $welcomePage = $sitetool.WelcomePage )
  #set( $currentPage = $sitetool.Page)
  <li>
    <a#if($welcomePage.equals($currentPage)) class="selected"#end href="$sitelinktool.getPage($welcomePage)">$utils.escape($welcomePage.Title)</a>
  </li>#end
#foreach( $level in $sitetool.Site.Sublevels )
  <li>
    <a#if($sitetool.hierarchyContains($level)) class="selected"#end href="$sitelinktool.getLevel($level)">$utils.escape($level.Title)</a>
    #if($level.hasSublevels())#submenu($level.Sublevels)#end
  </li>
#end
</ul>
#end

#macro(submenu $sublevels)
        <ul>
        #foreach( $sublevel in $sublevels)<li class="menu_main"><a#if($sitetool.hierarchyContains($sublevel)) class="selected"#end href="$sitelinktool.getLevel($sublevel)">$utils.escape($sublevel.Title)</a></li>#end
        </ul>
#end



#macro(pagemenu)
#set( $page = $sitetool.Page )
#if( $sitetool.getHasPrevious($page) || $sitetool.getHasNext($page) )
<hr style="border: 1px dotted silver; margin-bottom: 5px;" />
<div id="menu_page">
<p>
#if($sitetool.getHasPrevious($page))
  <a href="$sitelinktool.getPreviousPage($page)">previous</a> &nbsp; &nbsp;
#end
#if($sitetool.getHasNext($page))
  <a href="$sitelinktool.getNextPage($page)">next</a>
#end
</p>
</div>
#end
#end



#macro(imagemenu)
#set( $image = $sitetool.Image )
#if( $sitetool.getHasPrevious($image) || $sitetool.getHasNext($image) )
<hr  style="border:1px dotted silver; margin-bottom: 5px;" />
<div id="menu_image">
<p>
#if($sitetool.getHasPrevious($image))
  <a href="$gallerylinktool.getPrevious($image)">previous</a> &nbsp; &nbsp;
#end
#if($sitetool.getHasNext($image))
  <a href="$gallerylinktool.getNext($image)">next</a> &nbsp; &nbsp;
#end
<a href="$gallerylinktool.getGallery($image)">back to gallery</a>
</p>
</div>
#end
#end]]></text>
  </macro>
  <macro>
    <name><![CDATA[utils.vm]]></name>
    <text><![CDATA[#macro(breadcrumbsadder $list $separator)
  #set ( $container = '' )
  #foreach( $item in $list )
    #if( !$utils.isImage($item) && !$utils.isEmpty($!item.Title) )
      #if( $utils.isEmpty($!container) )
        #set( $container = "$item.Title" )
      #else
        #set( $container = "$container$separator$item.Title" )  
      #end
    #end
  #end
  $utils.escape("$container")
#end]]></text>
  </macro>
  <template id="8">
    <name><![CDATA[layout.html]]></name>
    <text><![CDATA[#parse('user_menu.vm')
#set( $st = $sitetool )
#set( $title = $st.Site.Title )
#if( !$title.equals($!st.Level.Title) ) #set( $title = "${title} - ${st.Level.Title}" )#end

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
  <title>$utils.escape($title)</title>$sitelinktool.addResource("robots.txt")
  $contexttool.AdditionalHeader
  <meta name="generator" content="Poor Man's CMS" />
  <link rel="stylesheet" type="text/css" href="$sitelinktool.Css" />
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
</head>

<body>
<div id="body">
<div id="nested">
<div id="header"> 
	<img src="$sitelinktool.getResource('p.png')" class="imageonleft" alt="P" width="50" height="50" />
	##$imagetagtool.setSrc("p.png").setAlt("P").setHeight(100).setWidth(100).putAttribute("class", "imageonleft").fitToSize()
  <h1>This is the header.</h1>
  <p>It is an uneditable text and is hard-coded in the layout.html.</p>
</div>

<div id="menu_main">
#mainmenu()
</div>

<!-- ********** begin content area ********** -->

$content

<!-- ********** end content area ********** -->

<div id="footer">
  <p>generated by <a href="http://poormans.sf.net">Poor Man's CMS</a></p>
</div>
</div>
</div>
</body>
</html>
]]></text>
  </template>
  <template id="3" type="gallery">
    <name><![CDATA[gallery-simple.html]]></name>
    <text><![CDATA[#parse('user_menu.vm')

<div id="content">
  <h1>$utils.escape($gallery.Title)</h1>
  #foreach($image in $gallery.Images)
  <div class="gallery_thumbnail">
    <p style="text-align: center;"><a href="$gallerylinktool.getImage($image)">$imagetagtool.setThumbnail($image).setAlt($utils.escape($image.Title))</a></p>
    <p>$utils.escape($image.Title)</p>
  </div>
  #end
  <div id="download"><a href="$gallerylinktool.getLinkToZip($gallery, 'gallery_zips')">Download the gallery '$utils.escape($gallery.Title)' as zip</a></div>
#pagemenu()
</div>]]></text>
  </template>
  <template id="4" type="gallery">
    <name><![CDATA[gallery.html]]></name>
    <text><![CDATA[#parse('user_menu.vm')
#parse('content.vm')
<div id="content">
  <h1>$utils.escape($gallery.Title)</h1>
  #contentview("field1" 605 520)
  
<!-- BEGIN THUMBNAIL MATRIX -->
  #set( $maxCols = 3 )
  #set( $matrix = $gallerytool.getThumbnailMatrix($gallery, $maxCols) )
  <table class="gallery" cellspacing="15">
    <colgroup>
      <col width="33%"/>
      <col width="34%"/>
      <col width="33%"/>
    </colgroup>
    #foreach($col in $matrix)
       <tr> <!-- begin thumbnail row -->
       #foreach($image in $col)
         <td class="thumbnail">
           #if($!image)<p>$utils.escape($image.title)</p>
           <p><a href="$gallerylinktool.getImage($image)">$imagetagtool.setThumbnail($image).setAlt($utils.escape($image.Title))</a></p>#end
         </td>
       #end
    </tr><!-- end thumbnail row -->
    #end
  </table>
<!-- END THUMBNAIL MATRIX -->

  #pagemenu()
</div>]]></text>
  </template>
  <template id="5" type="image">
    <name><![CDATA[image.html]]></name>
    <text><![CDATA[#parse('user_menu.vm')

<div id="content"> #set( $gallery = $image.Gallery)##
  <div id="gallery_image">
    <h1>$image.Title</h1><br />
    <p>$imagetagtool.setImage($image).setAlt($image.Title).fitToSize()  </p>
    <p>$image.Description</p>
  </div>
#pagemenu()
#imagemenu()
</div>]]></text>
  </template>
  <template id="6" type="page">
    <name><![CDATA[index.html]]></name>
    <text><![CDATA[#parse('content.vm')
#parse('user_menu.vm')

<div id="content">
  #contentview("field1" 605 650)
#pagemenu()
</div>]]></text>
  </template>
  <template id="7" type="page">
    <name><![CDATA[page with breadcrumbs]]></name>
    <text><![CDATA[#parse('content.vm')
#parse('user_menu.vm')
#parse('utils.vm')

<div id="content">
    <div id="breadcrumbs">
       <p>#breadcrumbsadder( $sitetool.Breadcrumbs ' > ')</p>
    </div>
    #contentview("field1" 605 520)
#pagemenu()
</div>]]></text>
  </template>
  <page name="home" templateID="6">
    <title><![CDATA[Home]]></title>
    <content name="field1">
      <value><![CDATA[
<h1>This is the welcome page&nbsp;...</h1>

<p>... of the site object!</p>

<p>&nbsp;</p>

<p>I know I&#39;ll never win a css award with this design. ;-) This is just a demo to show you how poormans works.&nbsp;</p>

<p>&nbsp;</p>

<p>Normally this page has another template e.g. for a nice greeting.</p>

<p>&nbsp;</p>

<p>This is a $linktagtool.setHref("/site/file/test.zip").setTagValue("zip") file managed by the FCKeditor!</p>

<p class="remark">Hint: If you add the link in the FCKeditor, it&rsquo;s important to set the protocol type to &rsquo;other&rsquo;, because that indicates, that is an internal link!</p>

]]></value>
    </content>
  </page>
  <level name="lev1">
    <title><![CDATA[Level with 1 page]]></title>
    <page name="frontpage" templateID="6">
      <title><![CDATA[]]></title>
      <content name="field1">
        <value><![CDATA[
<h1>Just one level with one!</h1>
<p>This is the welcome page of this level!</p>
<p class="remark">Each level must have&nbsp;at least&nbsp;one page. The first page of a level is called &rsquo;frontpage&rsquo;.</p>
]]></value>
      </content>
    </page>
  </level>
  <level name="lev2">
    <title><![CDATA[Level with pages]]></title>
    <page name="page1" templateID="6">
      <title><![CDATA[]]></title>
      <content name="field1">
        <value><![CDATA[
<h1>Level with more than one page</h1>
<h2>Page 1<br/>
</h2>
<p>Have a look at the end of this page. There is a menu to jump to the next/previous page.</p>
]]></value>
      </content>
    </page>
    <page name="page2" templateID="6">
      <title><![CDATA[]]></title>
      <content name="field1">
        <value><![CDATA[
<h1>Level with more than one page</h1>
<h2>Page 2<br/>
</h2>
<p>Have a look at the end of this page. There is a menu to jump to the next/previous page.<br/>
</p>

]]></value>
      </content>
    </page>
    <page name="page3" templateID="6">
      <title><![CDATA[]]></title>
      <content name="field1">
        <value><![CDATA[
 
  <h1>Level with more than one page</h1>  
  <h2>Page 3</h2>  
  <p>Have a look at the end of this page. There is a menu to jump to the next/previous page.</p> 
]]></value>
      </content>
    </page>
  </level>
  <level name="lev3">
    <title><![CDATA[Level with levels]]></title>
    <page name="frontpage" templateID="6">
      <title><![CDATA[]]></title>
      <content name="field1">
        <value><![CDATA[
 
  <h1>&nbsp;Frontpage of a level containing sublevels.</h1>  
  <p>&nbsp;</p>  
  <p>Each level must have a page!</p>  
  <br/>  
  <p>That&rsquo;s one rule you have to act on! This rule is valid even if the level contains sublevels.</p> 
]]></value>
      </content>
    </page>
    <level name="sub1">
      <title><![CDATA[Sublevel 1]]></title>
      <page name="frontpage" templateID="7">
        <title><![CDATA[]]></title>
        <content name="field1">
          <value><![CDATA[
<h1>Frontpage of Sublevel 1</h1>

<p>$imagetagtool.usedFromEditor().setSrc("/site/file/sflogo.png").putAttribute("style", "float: right; width: 88px; height: 31px; ").putAttribute("alt", "")</p>

<p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Vivamus massa neque, mattis et,interdum vel, tincidunt sed, risus. Suspendisse non ante eget nibh nonummy tempor. Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Morbi dignissim felis in ipsum. Praesent sem. In ut risus at quam accumsan consectetuer. Nunc vulputate aliquet diam. Ut in sapien non sapien pretium elementum. Cras pulvinar ultrices eros. Aliquam erat volutpat. Morbi hendrerit malesuada lacus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Ut consequat, leo in malesuada congue, urna odio adipiscing ante, sit amet rhoncus enim orci et dui.</p>

<p>Pellentesque ornare, massa eu tristique volutpat, odio massa lobortis est, iaculis sollicitudin ante felis id lorem. Maecenas imperdiet lacus id eros. Donec nunc. Pellentesque blandit porttitor est. Donec feugiat massa et lectus. Mauris ac odio. Curabitur molestie ante nec pede. Nam scelerisque metus eu ligula. Sed eros magna, ullamcorper quis, molestie vel, congue vitae, massa. Curabitur mollis ullamcorper sapien. Donec volutpat porta purus. Maecenas interdum dapibus nisi. Nam ultrices. Etiam leo turpis, ullamcorper in, aliquet et, vulputate sed, tortor. Nam laoreet mauris ut velit. Quisque auctor accumsan elit. Suspendisse vitae nunc.</p>

]]></value>
        </content>
      </page>
    </level>
    <level name="sub2">
      <title><![CDATA[Sublevel 2]]></title>
      <page name="frontpage" templateID="7">
        <title><![CDATA[]]></title>
        <content name="field1">
          <value><![CDATA[
 
  <h1>Frontpage of Sublevel 2</h1>  
  <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Vivamus massa neque, mattis et, interdum vel, tincidunt sed, risus. Suspendisse non ante eget nibh nonummy tempor. Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Morbi dignissim felis in ipsum. Praesent sem. In ut risus at quam accumsan consectetuer. Nunc vulputate aliquet diam. Ut in sapien non sapien pretium elementum. Cras pulvinar ultrices eros. Aliquam erat volutpat. Morbi hendrerit malesuada lacus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Ut consequat, leo in malesuada congue, urna odio adipiscing ante, sit amet rhoncus enim orci et dui.</p>  
  <p>Pellentesque ornare, massa eu tristique volutpat, odio massa lobortis est, iaculis sollicitudin ante felis id lorem. Maecenas imperdiet lacus id eros. Donec nunc. Pellentesque blandit porttitor est. Donec feugiat massa et lectus. Mauris ac odio. Curabitur molestie ante nec pede. Nam scelerisque metus eu ligula. Sed eros magna, ullamcorper quis, molestie vel, congue vitae, massa. Curabitur mollis ullamcorper sapien. Donec volutpat porta purus. Maecenas interdum dapibus nisi. Nam ultrices. Etiam leo turpis, ullamcorper in, aliquet et, vulputate sed, tortor. Nam laoreet mauris ut velit. Quisque auctor accumsan elit. Suspendisse vitae nunc.</p> 
]]></value>
        </content>
      </page>
    </level>
  </level>
  <level name="simple-gallery">
    <title><![CDATA[Simple gallery]]></title>
    <gallery name="simple-gallery" templateID="3" thumbnailMaxWidth="200" thumbnailMaxHeight="100" imageMaxWidth="480" imageMaxHeight="700" imageTemplateID="5">
      <title><![CDATA[Simple gallery example]]></title>
      <image fileName="gallery_properties.jpg">
        <title><![CDATA[Gallery properties]]></title>
        <description><![CDATA[Here you can adjust the basic properties of a gallery.]]></description>
      </image>
      <image fileName="image_properties.jpg">
        <title><![CDATA[Image properties]]></title>
        <description><![CDATA[Here you can adjust the basic properties of an image.]]></description>
      </image>
    </gallery>
  </level>
  <level name="tbl-gallery">
    <title><![CDATA[Table-Gallery]]></title>
    <gallery name="table-gallery" templateID="4" thumbnailMaxWidth="100" thumbnailMaxHeight="120" imageMaxWidth="480" imageMaxHeight="450" imageTemplateID="5">
      <title><![CDATA[Common table gallery]]></title>
      <content name="field1">
        <value><![CDATA[
<p>All images are taken from $linktagtool.setHref("http://co-photo.com").setTagValue("Conceptual Collections"), a free stock photo gallery under creative commons license.</p>
]]></value>
      </content>
      <image fileName="building1.jpg">
        <title><![CDATA[Building 1]]></title>
        <description><![CDATA[An image description.]]></description>
      </image>
      <image fileName="building2.jpg">
        <title><![CDATA[Building 2]]></title>
        <description><![CDATA[An image description.]]></description>
      </image>
      <image fileName="building3.jpg">
        <title><![CDATA[building 3]]></title>
        <description><![CDATA[An image description.]]></description>
      </image>
      <image fileName="smoke_air_polution.jpg">
        <title><![CDATA[Air polution]]></title>
        <description><![CDATA[An image description.]]></description>
      </image>
      <image fileName="skyline1.jpg">
        <title><![CDATA[SkyLine 1]]></title>
        <description><![CDATA[An image description.]]></description>
      </image>
      <image fileName="skyline2.jpg">
        <title><![CDATA[Skyline 2]]></title>
        <description><![CDATA[An image description.]]></description>
      </image>
    </gallery>
  </level>
</site>
